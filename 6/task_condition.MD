# День 6: Прогулка охранника

Историки снова используют своё загадочное устройство, на этот раз, чтобы перенести вас всех в прототипную лабораторию по производству костюмов на Северном полюсе... в 1518 году! Оказывается, что иметь прямой доступ к истории очень удобно для группы историков.

Однако нужно быть осторожным с временными парадоксами, и поэтому крайне важно избегать встреч с кем-либо из 1518 года, пока историки ищут начальника. К сожалению, по этой части лаборатории патрулирует единственный охранник.

Может быть, вы сможете заранее вычислить, куда направится охранник, чтобы историки могли безопасно провести свои поиски?

## Задача

Вы начинаете с составления карты (ваш входной файл), описывающей ситуацию. Например:

```
....#.....
.........#
..........
..#.......
.......#..
..........
.#..^.....
........#.
#.........
......#...
```

На карте показана текущая позиция охранника, обозначенная символом `^` (указывает, что охранник сейчас смотрит вверх относительно карты). Любые препятствия — ящики, столы, алхимические реакторы и т.д. — обозначены как `#`.

Охранники лабораторий в 1518 году следуют очень строгому патрульному протоколу, который включает повторение следующих шагов:

1. Если прямо перед вами есть препятствие, поверните направо на 90 градусов.
2. Иначе сделайте шаг вперёд.

Следуя этому протоколу, охранник несколько раз двигается вверх, пока не сталкивается с препятствием (в данном случае это груда прототипов костюмов):

```
....#.....
....^....#
..........
..#.......
.......#..
..........
.#........
........#.
#.........
......#...
```

Поскольку перед охранником теперь препятствие, он поворачивает направо, прежде чем продолжить движение в новом направлении:

```
....#.....
........>#
..........
..#.......
.......#..
..........
.#........
........#.
#.........
......#...
```

Достигнув другого препятствия (катушка из сверхдлинных полимеров), охранник снова поворачивает направо и продолжает двигаться вниз:

```
....#.....
.........#
..........
..#.......
.......#..
..........
.#......v.
........#.
#.........
......#...
```

Этот процесс продолжается некоторое время, но в итоге охранник покидает пределы карты (после того, как проходит мимо бака с универсальным растворителем):

```
....#.....
.........#
..........
..#.......
.......#..
..........
.#........
........#.
#.........
......#v..
```

Предсказывая маршрут охранника, вы можете определить, какие конкретные позиции в лаборатории будут включены в патрульный маршрут. Включая начальную позицию охранника, позиции, посещённые охранником до выхода за пределы карты, отмечены символом `X`:

```
....#.....
....XXXXX#
....X...X.
..#.X...X.
..XXXXX#X.
..X.X.X.X.
.#XXXXXXX.
.XXXXXXX#.
#XXXXXXX..
......#X..
```

В этом примере охранник посетит 41 уникальную позицию на вашей карте.

## Вопрос

Спрогнозируйте маршрут охранника. Сколько уникальных позиций он посетит до выхода за пределы карты?

--- Часть Вторая ---

Пока Историки начинают работать в обход маршрута патрулирования охранника, вы берете их хитрое устройство и выходите из лаборатории. В безопасном убежище кладовой вы путешествуете во времени на последние несколько месяцев и записываете ночной статус охранного поста лаборатории на стены кладовой.

Вернувшись спустя всего несколько секунд, вы узнаете от Историков, что область патрулирования охранника слишком велика, чтобы безопасно исследовать лабораторию без риска быть пойманным.

К счастью, Историки уверены, что добавление единственного нового препятствия не вызовет временного парадокса. Они хотят разместить новое препятствие таким образом, чтобы охранник застрял в петле, что сделает остальную часть лаборатории безопасной для исследования.

Чтобы минимизировать вероятность создания временного парадокса, Историки хотят узнать все возможные позиции для такого препятствия. Новое препятствие нельзя разместить на начальной позиции охранника — он находится там прямо сейчас и заметит это.

В приведенном выше примере есть только 6 различных позиций, где новое препятствие может привести к тому, что охранник застрянет в петле. Диаграммы этих шести ситуаций используют символы:
- **O** для обозначения нового препятствия.
- **|** для позиции, где охранник движется вверх/вниз.
- **-** для позиции, где охранник движется влево/вправо.
- **+** для позиции, где охранник движется как вверх/вниз, так и влево/вправо.

Пример 1: Разместить печатный пресс рядом с начальной позицией охранника:
```
....#.....
....+---+#
....|...|.
..#.|...|.
....|..#|.
....|...|.
.#.O^---+.
........#.
#.........
......#...
```

Пример 2: Разместить кучу прототипов в правом нижнем квадранте карты:
```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
......O.#.
#.........
......#...
```

Пример 3: Разместить ящик с тканью прототипа рядом со столом в правом нижнем квадранте:
```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
.+----+O#.
#+----+...
......#...
```

Пример 4: Разместить ретроэнкабулятор в левом нижнем углу:
```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
..|...|.#.
#O+---+...
......#...
```

Пример 5: Разместить ретроэнкабулятор немного правее:
```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
....|.|.#.
#..O+-+...
......#...
```

Пример 6: Разместить бак с суверенным клеем рядом с баком универсального растворителя:
```
....#.....
....+---+#
....|...|.
..#.|...|.
..+-+-+#|.
..|.|.|.|.
.#+-^-+-+.
.+----++#.
#+----++..
......#O..
```

Историки могут выбрать любое из этих мест для препятствия, чтобы охранник застрял в петле. В этом примере существует 6 различных позиций, которые можно использовать для размещения нового препятствия.

Вам нужно заставить охранника застрять в петле, добавив одно новое препятствие. Сколько различных позиций вы можете выбрать для этого препятствия?

