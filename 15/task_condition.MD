# --- День 15: Проблемы на складе ---

Вы оказались обратно в своей мини-подводной лодке! Каждый Историк управляет своей подводной лодкой в разных направлениях; возможно, Главный тоже где-то здесь.

Вы видите огромное скопление светящихся рыб. При ближайшем рассмотрении они выглядят обеспокоенными, поэтому вы направляете свою подводную лодку ближе, чтобы понять, в чём дело.

Поскольку популяция светящихся рыб быстро растёт, им нужно много еды, и эта еда должна где-то храниться. Именно поэтому они построили сложные складские комплексы, управляемые роботами!

Светящиеся рыбы выглядят так обеспокоено, потому что потеряли контроль над роботом, который управляет одним из их самых важных складов! Этот робот сейчас толкает коробки по складу, не обращая внимания на логистику и управление запасами.

Никто из светящихся рыб не решается подойти к непредсказуемому роботу, чтобы его выключить. Однако если вы сможете предсказать движения робота, возможно, они найдут безопасный способ справиться с ситуацией.

У светящихся рыб уже есть карта склада и список движений, которые робот будет пытаться совершить (ваши входные данные). Проблема в том, что эти движения иногда будут неудачными, так как коробки перемещаются, а робот может столкнуться с препятствиями.

## Пример:

```
########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

<^^>>>vv<v>>v<<
```


### Движения робота:

```
Initial state:
########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move <:
########
#..O.O.#
##@.O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move ^:
########
#.@O.O.#
##..O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move ^:
########
#.@O.O.#
##..O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move >:
########
#..@OO.#
##..O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move >:
########
#...@OO#
##..O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move >:
########
#...@OO#
##..O..#
#...O..#
#.#.O..#
#...O..#
#......#
########

Move v:
########
#....OO#
##..@..#
#...O..#
#.#.O..#
#...O..#
#...O..#
########

Move v:
########
#....OO#
##..@..#
#...O..#
#.#.O..#
#...O..#
#...O..#
########

Move <:
########
#....OO#
##.@...#
#...O..#
#.#.O..#
#...O..#
#...O..#
########

Move v:
########
#....OO#
##.....#
#..@O..#
#.#.O..#
#...O..#
#...O..#
########

Move >:
########
#....OO#
##.....#
#...@O.#
#.#.O..#
#...O..#
#...O..#
########

Move >:
########
#....OO#
##.....#
#....@O#
#.#.O..#
#...O..#
#...O..#
########

Move v:
########
#....OO#
##.....#
#.....O#
#.#.O@.#
#...O..#
#...O..#
########

Move <:
########
#....OO#
##.....#
#.....O#
#.#O@..#
#...O..#
#...O..#
########

Move <:
########
#....OO#
##.....#
#.....O#
#.#O@..#
#...O..#
#...O..#
########
```


`@` — текущая позиция робота. Символы `^`, `v`, `<`, `>` обозначают направления движений робота: вверх, вниз, влево и вправо соответственно.

Коробки (`O`) будут перемещаться вместе с роботом, если он попытается их толкнуть. Если робот или коробка упираются в стену (`#`), движение не совершается. 

После выполнения всех движений карта может выглядеть так:

```
##########
#.O.O.OOO#
#........#
#OO......#
#OO@.....#
#O#.....O#
#O.....OO#
#O.....OO#
#OO....OO#
##########
```


### Координаты GPS

Светящиеся рыбы используют свою систему координат (GPS) для отслеживания расположения коробок. Координата GPS коробки равна:
`100 * 1 + 4 = 104.`

```
#######
#...O..
#......
```

У коробки:  
- Расстояние от верхнего края: `1`  
- Расстояние от левого края: `4`  
Координата GPS: `100 * 1 + 4 = 104`.

Суммируйте координаты GPS всех коробок после выполнения всех движений. В большом примере итоговая сумма координат равна **10092**, а в маленьком примере — **2028**.

---

### Ваша задача:

Смоделируйте движения робота и коробок на складе. После выполнения всех движений вычислите сумму GPS-координат всех коробок.

# Задача

Люминесцентные рыбы используют вашу информацию, чтобы найти безопасный момент для того, чтобы подплыть и выключить неисправного робота! Пока они начинают готовиться к празднику в вашу честь, начинают поступать сообщения о том, что робот на складе №2 также вышел из строя.

Планировка второго склада удивительно похожа на первый, с одним ключевым отличием: **всё, кроме робота, становится в два раза шире**! Список движений робота **не меняется**.

## Увеличение карты склада

Чтобы получить карту более широкого склада, используйте исходную карту и для каждой плитки выполните следующие изменения:

- Если плитка — `#`, новая карта содержит `##`.
- Если плитка — `O`, новая карта содержит `[]`.
- Если плитка — `.`, новая карта содержит `..`.
- Если плитка — `@`, новая карта содержит `@.`.

Это создаёт новую карту склада, которая в два раза шире, с коробками, представленными как `[]`. Размер робота **не меняется**.

### Пример преобразованной карты:

Исходная карта:
```
#######
#...#.#
#.....#
#..OO@#
#..O..#
#.....#
#######
```
Преобразованная карта:

```
##############
##......##..##
##..........##
##....[][]@.##
##....[]....##
##..........##
##############
```


## Толкание коробок

На новом складе робот может толкать коробки шириной `[]`, и эти коробки могут толкать другие коробки, если они находятся на одном уровне.

### Пример:

Исходная карта:
```
Initial state:
##############
##......##..##
##..........##
##....[][]@.##
##....[]....##
##..........##
##############

Move <:
##############
##......##..##
##..........##
##...[][]@..##
##....[]....##
##..........##
##############

Move v:
##############
##......##..##
##..........##
##...[][]...##
##....[].@..##
##..........##
##############

Move v:
##############
##......##..##
##..........##
##...[][]...##
##....[]....##
##.......@..##
##############

Move <:
##############
##......##..##
##..........##
##...[][]...##
##....[]....##
##......@...##
##############

Move <:
##############
##......##..##
##..........##
##...[][]...##
##....[]....##
##.....@....##
##############

Move ^:
##############
##......##..##
##...[][]...##
##....[]....##
##.....@....##
##..........##
##############

Move ^:
##############
##......##..##
##...[][]...##
##....[]....##
##.....@....##
##..........##
##############

Move <:
##############
##......##..##
##...[][]...##
##....[]....##
##....@.....##
##..........##
##############

Move <:
##############
##......##..##
##...[][]...##
##....[]....##
##...@......##
##..........##
##############

Move ^:
##############
##......##..##
##...[][]...##
##...@[]....##
##..........##
##..........##
##############

Move ^:
##############
##...[].##..##
##...@.[]...##
##....[]....##
##..........##
##..........##
##############
```

## Вычисление координат

Для коробок шириной `[]` расстояние вычисляется от края карты до ближайшего края коробки. 

### Пример:

Карта:

```
##########
##...[]...
##........
```

Коробка находится на расстоянии `1` от верхнего края карты и `5` от левого края карты. GPS-координата: `100 * 1 + 5 = 105`.

## Итоговая карта и результат

Итоговая карта для большого примера:
```
####################
##[].......[].[][]##
##[]...........[].##
##[]........[][][]##
##[]......[]....[]##
##..##......[]....##
##..[]............##
##..@......[].[][]##
##......[][]..[]..##
####################
```

**Сумма GPS-координат коробок:** **9021**.
