### --- День 12: Садовые Группы ---

Почему бы не поискать Главного Историка рядом с садовником и его огромной фермой? Здесь полно еды, так что Историки могут чем-нибудь подкрепиться, пока ищут.

Вы вот-вот расположитесь рядом со сложным расположением садовых участков, когда некоторые Эльфы просят вас о помощи. Они хотели бы оградить забором каждую группу садовых участков, но не могут понять, сколько заборов им нужно заказать и сколько это будет стоить. Они передают вам карту (ваши входные данные к задаче) с расположением садовых участков.

Каждый садовый участок выращивает только один вид растения и на карте обозначен одной буквой. Когда несколько участков с одинаковым растением касаются друг друга горизонтально или вертикально, они образуют регион.

Например:
```
AAAA
BBCD
BBCC
EEEC
```

Этот 4x4 участок содержит растения пяти разных типов (обозначенных буквами A, B, C, D и E), каждый из которых сгруппирован в свой регион.

Чтобы точно рассчитать стоимость забора вокруг отдельного региона, нужно знать площадь и периметр этого региона.

**Площадь региона** — это просто количество садовых участков в данном регионе. В приведённом примере растения типов A, B и C образуют регионы площадью 4, растения типа E — регион площадью 3, а тип D — регион площадью 1.

Каждый садовый участок — это квадрат со стороной, приравненной к единице, поэтому у каждого участка есть 4 стороны. **Периметр региона** — это количество сторон участков в регионе, которые не соприкасаются с другим участком того же региона. В том же примере регион A и регион C имеют периметр 10, регионы B и E имеют периметр 8, а единственный участок типа D имеет периметр 4.

Наглядно показав стороны участков, образующих периметр, с помощью символов `-` и `|`, можно подсчитать периметры регионов по карте. В примере:
- A и C имеют периметр 10,
- B и E имеют периметр 8,
- D (один участок) — периметр 4.

```
+-+-+-+-+
|A A A A|
+-+-+-+-+     +-+
              |D|
+-+-+   +-+   +-+
|B B|   |C|
+   +   + +-+
|B B|   |C C|
+-+-+   +-+ +
          |C|
+-+-+-+   +-+
|E E E|
+-+-+-+
```

Растения одного и того же типа могут встречаться в нескольких отдельных регионах, и регионы могут даже быть вложены друг в друга. Например:
```
OOOOO
OXOXO
OOOOO
OXOXO
OOOOO
```

На этой карте есть пять регионов: один большой регион, содержащий все участки с буквой O, и четыре маленьких региона по одному участку с буквой X.

Четыре X-региона имеют площадь по 1 и периметр по 4, а значит их стоимость 1*4 = 4 для каждого. Большой регион O имеет площадь 21. Его наружный край даёт периметр 20, плюс граница с каждым X-регионом добавляет ещё по 4 к периметру, в итоге периметр для O равен 36. Стоимость для региона O: 21 * 36 = 756. Суммарная стоимость всех регионов: 756 (O) + 4*(4) (четыре региона X по 4) = 756 + 16 = 772.

Цена забора для региона равна произведению площади региона на его периметр. Общая стоимость забора для всей карты — сумма цен заборов для всех регионов на карте.

В первом примере:
- Регион A: площадь 4, периметр 10 → цена 4 * 10 = 40
- Регион B: площадь 4, периметр 8 → цена 4 * 8 = 32
- Регион C: площадь 4, периметр 10 → цена 4 * 10 = 40
- Регион D: площадь 1, периметр 4 → цена 4
- Регион E: площадь 3, периметр 8 → цена 3 * 8 = 24

Общая стоимость: 40 + 32 + 40 + 4 + 24 = 140.

Во втором примере:
- Большой регион O: площадь 21, периметр 36 → 21 * 36 = 756
- Четыре маленьких X-региона: по 1 * 4 = 4 каждый, всего 16
Итого: 756 + 16 = 772.

Вот ещё больший пример:

```
RRRRIICCFF
RRRRIICCCF
VVRRRCCFFF
VVRCCCJFFF
VVVVCJJCFE
VVIVCCJJEE
VVIIICJJEE
MIIIIIJJEE
MIIISIJEEE
MMMISSJEEE
```


Он содержит:
- Регион R: площадь 12, периметр 18 → цена 12 * 18 = 216
- Регион I: площадь 4, периметр 8 → цена 4 * 8 = 32
- Регион C: площадь 14, периметр 28 → цена 14 * 28 = 392
- Регион F: площадь 10, периметр 18 → цена 10 * 18 = 180
- Регион V: площадь 13, периметр 20 → цена 13 * 20 = 260
- Регион J: площадь 11, периметр 20 → цена 11 * 20 = 220
- Ещё один регион C: площадь 1, периметр 4 → цена 4
- Регион E: площадь 13, периметр 18 → цена 13 * 18 = 234
- Ещё один регион I: площадь 14, периметр 22 → цена 14 * 22 = 308
- Регион M: площадь 5, периметр 12 → цена 5 * 12 = 60
- Регион S: площадь 3, периметр 8 → цена 3 * 8 = 24

Суммарная стоимость этого большого примера: 216 + 32 + 392 + 180 + 260 + 220 + 4 + 234 + 308 + 60 + 24 = 1930.

**Вопрос**: Какова суммарная стоимость забора для всех регионов вашей карты?

### --- Часть Вторая ---

К счастью, Эльфы заказывают столько забора, что получают оптовую скидку!

При применении оптовой скидки вместо использования периметра для расчёта цены нужно использовать количество сторон у каждого региона. Каждая прямая секция забора считается за одну сторону, независимо от её длины.

Рассмотрим прежний пример:

```
AAAA
BBCD
BBCC
EEEC
```

Регион с растениями типа A имеет 4 стороны, так же как и регионы с B, D и E. Однако более сложный регион с растениями типа C имеет 8 сторон!

При новом методе цена региона — это произведение площади региона на количество его сторон. Для регионов A, B, C, D и E, исходя из новой методики, цены будут: A (16), B (16), C (32), D (4), E (12). Суммируя их, получаем общую стоимость 80.

Во втором примере (с растениями типов X и O) общая стоимость будет 436.

Вот ещё одна карта с регионом, заполненным растениями типа E в форме буквы E:

```
EEEEE
EXXXX
EEEEE
EXXXX
EEEEE
```

Регион с E имеет площадь 17 и 12 сторон, стоимость: 17 * 12 = 204. Добавив два региона с X, общая стоимость составляет 236.

Эта карта имеет общую стоимость 368:

```
AAAAAA
AAABBA
AAABBA
ABBAAA
ABBAAA
AAAAAA
```

Она содержит два региона с B (каждый по 4 стороны) и один регион с A (у него 4 стороны снаружи и 8 внутри, всего 12 сторон). Будьте особенно внимательны при подсчёте сторон для подобных регионов. Забор не пересекает внутренние области, где регионы касаются друг друга по диагонали.

В большом примере из предыдущей части теперь цены следующие:
- Регион R: площадь 12, сторон 10 → 12 * 10 = 120
- Регион I: площадь 4, сторон 4 → 4 * 4 = 16
- Регион C: площадь 14, сторон 22 → 14 * 22 = 308
- Регион F: площадь 10, сторон 12 → 10 * 12 = 120
- Регион V: площадь 13, сторон 10 → 13 * 10 = 130
- Регион J: площадь 11, сторон 12 → 11 * 12 = 132
- Ещё один регион C: площадь 1, сторон 4 → 1 * 4 = 4
- Регион E: площадь 13, сторон 8 → 13 * 8 = 104
- Ещё один регион I: площадь 14, сторон 16 → 14 * 16 = 224
- Регион M: площадь 5, сторон 6 → 5 * 6 = 30
- Регион S: площадь 3, сторон 6 → 3 * 6 = 18

Суммируя всё: 120 + 16 + 308 + 120 + 130 + 132 + 4 + 104 + 224 + 30 + 18 = 1206.

**Вопрос**: Какова новая общая стоимость забора для всех регионов на вашей карте?
